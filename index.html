<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#000000">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">
    <style>
      body {
        font-family: 'Roboto', sans-serif;
      }  
    </style>

    <title>SAM Demo</title>
  </head>
  <body>
    <noscript>
      Dude - why no Javascript :-(
    </noscript>

    <div id="root">
        API URL: <input type="text" name="apiUrl" id="apiUrl" style="background-color:black;color:black;width:20px;" onchange="onUrlChange()" />
        &nbsp;<small><span id="apiUrlLabel" /></small>
        <hr />
        <div style="display:block">
          <div id="leftDiv" style="float:left;align-content: center;padding:10px;margin:10px">
            LEFT
            <input type="number" name="left" id="left" />
          </div>
          <div id="leftDiv" style="float:left;align-content: center;padding:10px;margin:10px">
            +
          </div>
          <div id="rightDiv" style="float:left;align-content: center;padding:10px;margin:10px">
            RIGHT
            <input type="number" name="right" id="right" />
          </div>
          <div id="answerDiv" style="float:left;align-content: left;padding:10px;margin:10px">
            <button onclick="calculate()">Calculate</button>
            <span id="answer">?</span>
          </div>
        </div>
        <div style="clear:both">
          <hr />

          <button onclick="clearEvents()" style="clear:both;float:right;font-size:0.8em;">Clear</button>
          <pre id="events" rows=10 cols=50 style="width:100%" />
        </div>
    </div>

    <script type="text/javascript">
      function calculate() {
        var e = document.getElementById("apiUrl");
        var events = document.getElementById("events");
        var url = (e.value || "").trim();
        if (url.indexOf("https://") != 0) {
          events.innerHTML += "\nAPI URL not specified...";
        } else {
          var leftVal = document.getElementById("left").value * 1.0 || 0.0;
          var rightVal = document.getElementById("right").value * 1.0 || 0.0;
          url += "?left=" + leftVal + "&right=" + rightVal;
          events.innerHTML += "\nCalling API @: " + strippedUrl(url);
          fetch(url, { mode:"cors" }).then( value => {
            events.innerHTML += "\n   Result:" + value;
          })
        }
      }

      function clearEvents() {
        var events = document.getElementById("events");
        events.innerHTML = "";
      }
      function onUrlChange() {
        var e = document.getElementById("apiUrl");
        if (e) {
          var x = document.getElementById("apiUrlLabel");
          if (x) x.innerHTML = strippedUrl(e.value);
        }
      }
      function strippedUrl(url) {
        var u = url || "?";
        var pos = u.indexOf("/");
        if (pos > -1) {
          var pos2 = u.indexOf(".");
          u = u.substring(0, pos) + "//*****" + u.substring(pos2);
        }
        return u;
      }
    </script>
  </body>
</html>
